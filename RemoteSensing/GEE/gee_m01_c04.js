var geometry = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-39.450535018376335, -8.54397481382652],
          [-39.456028182438835, -8.554499559194062],
          [-39.45671482794665, -8.559592073541808],
          [-39.450535018376335, -8.558573576121104],
          [-39.43920536749743, -8.557555075975657],
          [-39.42924900763415, -8.550765005397158],
          [-39.4265024256029, -8.54397481382652],
          [-39.417576034001335, -8.533449777999325],
          [-39.40281315558337, -8.524622104883916],
          [-39.384617049626335, -8.52428257492218],
          [-39.36882420294665, -8.527677860966907],
          [-39.352688033513054, -8.537524019850347],
          [-39.348911483220085, -8.543295788018469],
          [-39.3441049646654, -8.547030415000126],
          [-39.3441049646654, -8.552123029195203],
          [-39.34135838263415, -8.55585756967913],
          [-39.335178573063835, -8.555178565041867],
          [-39.32556553595446, -8.55551806751183],
          [-39.318699080876335, -8.554839062269284],
          [-39.3111459802904, -8.55585756967913],
          [-39.304966170720085, -8.552802039279126],
          [-39.29741307013415, -8.55110451180041],
          [-39.291233260563835, -8.551444017901193],
          [-39.28608341925524, -8.549067468843864],
          [-39.28539677374743, -8.541598218209662],
          [-39.28505345099352, -8.531412640770705],
          [-39.28471012823962, -8.524961634544072],
          [-39.29157658331774, -8.523263983227585],
          [-39.308742721013054, -8.52122679169724],
          [-39.31904240363024, -8.518850054528611],
          [-39.32316227667712, -8.513756996586757],
          [-39.3276254724779, -8.50832432674966],
          [-39.33689518683337, -8.503910225761874],
          [-39.348911483220085, -8.504928868965376],
          [-39.35921116583727, -8.505607962929863],
          [-39.368137557438835, -8.504928868965376],
          [-39.381870467595085, -8.504928868965376],
          [-39.38599034064196, -8.505607962929863],
          [-39.392856795720085, -8.505607962929863],
          [-39.39766331427477, -8.501533381090397],
          [-39.40246983282946, -8.501533381090397],
          [-39.41379948370837, -8.498477416285018],
          [-39.4210092615404, -8.49813786313639],
          [-39.429077346257195, -8.50475909528618],
          [-39.43148060553454, -8.507475465125228],
          [-39.431823928288445, -8.509852272932383],
          [-39.433540542057976, -8.510191815700622],
          [-39.43542881720446, -8.511380213018327],
          [-39.43645878546618, -8.514605844284533],
          [-39.436287124089226, -8.516982607821536],
          [-39.437317092350945, -8.520547725441933],
          [-39.43920536749743, -8.52292445205963],
          [-39.443840224675164, -8.528866203955777],
          [-39.449333388737664, -8.539730882694968]]]);

Map.setCenter(-38.566884116782056, -9.119516515150766)

var icL8 = ee.ImageCollection("LANDSAT/LC08/C02/T1_TOA");

// Índice de Vegetação por Diferença Normalizada (NDVI);

var ndvi = function(image){
  return image.expression(
      '(NIR - RED)/(NIR + RED)',
      {
        'NIR': image.select('B5'),
        'RED': image.select('B4')
      })
};

// Índice de vegetação realçado (EVI)

var evi = function(image){
  return image.expression(
      '2.5 * (NIR - RED)/(NIR + 2.4 * RED + 1)',
      {
        'NIR': image.select('B5'),
        'RED': image.select('B4')
      }
    )
};

// Índice de vegetação ajustado ao solo (SAVI)

var savi = function(image){
  return image.expression(
      '(1 + L) * (NIR - RED)/(NIR + RED + L)',
      {
        'NIR': image.select('B5'),
        'RED': image.select('B4'),
        'L': 0.2
      }
    )
};

// Seleção e visualização de imagens na biblioteca

// Utilização de filtros nas bibliotecas

// Operações e processamento de imagens (Reducers)

// Utilização de variáveis no processamento


// Máscara para remoção de água e valor de pixel zero

var maskL8 = function(image) {
  var qa = image.select('QA_PIXEL');
  
  var mask = qa.bitwiseAnd(1 << 4).eq(0);
  return image.updateMask(mask)
};


// Make a color palette

var vis = {
  min: 0,
  max: 1,
  palette: [
      'FFFFFF', 'CE7E45', 'DF923D', 'F1B555', 'FCD163', '99B718', 
      '74A901', '66A000', '529400', '3E8601', '207401', '056201', 
      '004C00', '023B01',  '012E01', '011D01', '011301'
    ]
}

// Adicionando mapa ao display

Map.addLayer(icL8.map(maskL8).map(ndvi).median().clip(geometry), vis, 'NDVI MEDIAN')
Map.addLayer(icL8.map(maskL8).map(evi).median().clip(geometry), vis, 'EVI MEDIAN')
Map.addLayer(icL8.map(maskL8).map(savi).median().clip(geometry), vis, 'SAVI MEDIAN')